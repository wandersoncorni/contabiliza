(()=>{"use strict";var t={669:t=>{t.exports=jQuery}},e={};function a(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,a),i.exports}a.d=(t,e)=>{for(var o in e)a.o(e,o)&&!a.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.d({},{Y7:()=>k,zQ:()=>w});var o=a(669);const n=[];function i(){fetch("/api/v1/categorias-servicos").then((t=>t.json())).then((t=>{let e='<option value="">Escolha uma categoria</option>';t.forEach((t=>{e+=`<option value="${t.id}">${t.nome}</option>`})),o("#lista-categorias").html(e)}))}function r(){o("#lista-servicos option").length||fetch("/api/v1/servicos").then((t=>t.json())).then((t=>{let e="";t.forEach((t=>{e+=`<option class="bg-white" value="${t.id}">${t.nome}</option>`})),o("#lista-servicos").html(e).prop("size",o("#lista-servicos option").length)}))}function c(){fetch("/api/v1/planos-servicos").then((t=>t.json())).then((t=>{let e='<option value="">Escolha um plano</option>';t.forEach((t=>{e+=`<option value="${t.id}">${t.nome}</option>`})),o("#lista-planos").html(e)}))}var s=a(669);let l=[];function d(){s.fn.dataTable.isDataTable("#tb-services-plans")&&s("#tb-services-plans").DataTable().destroy(),s("#tb-services-plans").DataTable({ajax:(t,e)=>fetch("/api/v1/planos-servicos").then((async t=>{t.ok?(l=await t.json(),e({data:l})):e({data:[]})})),columns:[{data:"nome"},{data:"descricao"},{data:t=>p(t.valor_mensal)},{data:t=>p(t.valor_anual)},{data:t=>t.ativo?'<span class="text-success">Ativo</span>':'<span class="text-danger">Inativo</span>'},{data:t=>k(t.id)}],columnDefs:[{orderable:!1,targets:[2,3,4]}],order:[[0,"asc"]]})}function p(t){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t)}function m(t){return t.replace(/[^\d,]/g,"").replace(".","").replace(",",".")}function u(t,e="/api/v1/plano-servico"){fetch(e,t).then((async t=>{const e=await t.json();t.ok?(w(),d(),c(),s("#form-service-plan")[0].reset()):Swal.fire("Erro ao enviar a requisição:",e.message,"error")})).catch((t=>console.error("Erro ao enviar a requisição:",t)))}var f=a(669);let h=[];function v(){f.fn.dataTable.isDataTable("#tb-services")&&f("#tb-services").DataTable().destroy(),f("#tb-services").DataTable({ajax:(t,e)=>fetch("/api/v1/servicos").then((async t=>{t.ok?(h=await t.json(),e({data:h})):e({data:[]})})),columns:[{data:"nome"},{data:t=>k(t.id)}],columnDefs:[{orderable:!1,targets:[1]}],order:[[0,"asc"]]})}function g(t,e="/api/v1/servico"){fetch(e,t).then((async t=>{t.ok&&(await t.json(),v(),r(),f("#form-service")[0].reset())}))}var b=a(669);let _=[];function y(){b.fn.dataTable.isDataTable("#tb-categories")&&b("#tb-categories").DataTable().destroy(),b("#tb-categories").DataTable({ajax:(t,e)=>fetch("/api/v1/categorias-servicos").then((async t=>{t.ok?(_=await t.json(),e({data:_})):e({data:[]})})),columns:[{data:"nome"},{data:t=>k(t.id)}],columnDefs:[{orderable:!1,targets:[1]}],order:[[0,"asc"]]})}function x(t,e="/api/v1/categoria-servico"){fetch(e,t).then((async t=>{t.ok&&(await t.json(),y(),i(),b("#form-category")[0].reset())}))}var T=a(669);let E=[];function w(){T.fn.dataTable.isDataTable("#tb-plans")&&T("#tb-plans").DataTable().destroy(),T("#tb-plans").DataTable({ajax:function(t,e){fetch("/api/v1/planos-servicos",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((async t=>{const a={data:[]};if(t.ok){const e=await t.json(),o=[];E=e,e.forEach((t=>{const e=o.length;o.find((e=>e.id==t.id))||o.push({id:t.id,nome:t.nome,categorias:[],servicos:[]}),t.categorias_servicos.forEach((t=>{o[e].categorias.find((e=>e.id==t.categoria.id))||o[e].categorias.push({id:t.categoria.id,nome:t.categoria.nome}),o[e].servicos.find((e=>e.id==t.servico.id))||o[e].servicos.push({id:t.servico.id,nome:t.servico.nome,categoria_id:t.categoria.id})}))})),a.data=o}e(a)}))},columns:[{data:"nome"},{data:t=>{const e=T("<ul />",{class:"list-group"});return t.categorias.forEach((a=>{e.append(T("<li />",{class:"list-group-item"}).html(a.nome).append([T("<button />",{type:"button",class:"btn btn-xs btn-transparent text-info ms-2","data-plano_id":t.id,"data-categoria_id":a.id}).html(T("<i />",{class:"heroicon heroicon-pencil-square"})),T("<button />",{type:"button",class:"btn btn-xs btn-transparent text-danger ms-2","data-plano_id":t.id,"data-categoria_id":a.id,"data-action":"delete_category"}).html(T("<i />",{class:"heroicon heroicon-trash"}))]))})),e.prop("outerHTML")}},{data:t=>{const e=T("<ul />",{class:"list-group"});return t.servicos.forEach((a=>{e.append(T("<li />",{class:"list-group-item"}).html(a.nome).append([T("<button />",{type:"button",class:"btn btn-xs btn-transparent text-info ms-2","data-plano_id":t.id,"data-categoria_id":a.categoria_id,"data-servico_id":a.id}).html(T("<i />",{class:"heroicon heroicon-pencil-square"})),T("<button />",{type:"button",class:"btn btn-xs btn-transparent text-danger ms-2","data-plano_id":t.id,"data-categoria_id":a.categoria_id,"data-servico_id":a.id,"data-action":"delete_service"}).html(T("<i />",{class:"heroicon heroicon-trash"}))]))})),e.prop("outerHTML")}},{data:t=>T("<button />",{type:"button",class:"btn btn-xs btn-transparent text-danger","data-plano_id":t.id,"data-action":"delete_plan"}).html(T("<i />",{class:"heroicon heroicon-trash"})).prop("outerHTML")}],columnDefs:[{orderable:!1,targets:[3]}],order:[[0,"asc"]]})}function k(t,e){return T("<div />").append([T("<button />",{class:"btn btn-xs d-plex me-2 btn-transparent text-info","data-id":t,"data-action":"edit"}).append(T("<i />",{class:"heroicon heroicon-pencil-square"})),T("<button />",{class:"btn btn-xs d-plex btn-transparent text-danger","data-id":t,"data-action":"delete"}).append(T("<i />",{class:"heroicon heroicon-trash"}))]).prop("innerHTML")}T(document).ready((function(){w(),T("#app-content #tb-plans").on("click","button",(function(t){t.preventDefault();let e="plano",a="api/v1/plano-servico/"+T(this).data("plano_id");"delete_category"==T(this).data("action")?(e="categoria",a="api/v1/categoria-plano/"+T(this).data("plano_id")+"/"+T(this).data("categoria_id")):"delete_service"==T(this).data("action")&&(e="serviço",a="api/v1/servico-plano/"+T(this).data("plano_id")+"/"+T(this).data("categoria_id")+"/"+T(this).data("servico_id")),["delete_plan","delete_category","delete_service"].includes(T(this).data("action"))?Swal.fire({title:`Exclusão de ${e}`,text:"Voce não poderá reverter isso!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, excluir!"}).then((t=>{t.isConfirmed&&fetch(a,{method:"DELETE",headers:{"X-CSRF-TOKEN":T('meta[name="csrf-token"]').attr("content"),"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"include"}).then((async t=>{const a=await t.json();t.ok?T("#tb-plans").DataTable().ajax.reload():Swal.fire(`Erro ao excluir ${e}:`,a.message,"error")})).catch((t=>console.error(`Erro ao excluir ${e}:`,t)))})):function(t,e){o("#modal-form-plan").modal("show");const a=setInterval((()=>{if(o('#modal-form-plan [name="plano_servico_id"]').length>0){clearInterval(a),o('#modal-form-plan [name="plano_servico_id"]').val(t.id),o('#modal-form-plan [name="categoria_servico_id"]').val(e);const n=[];t.categorias_servicos.forEach((t=>{t.categoria.id==e&&n.push(t.servico.id)})),o('#modal-form-plan [name="servico_id"]').val(n),o('#form-config-plan [name="servico_id"] option:selected').each((function(){o(this).html("&#x2714;"+o(this).text()),o(this).addClass("bg-black"),o(this).addClass("text-white")}))}}),500)}(E.find((t=>t.id==T(this).data("plano_id"))),T(this).data("categoria_id"))})),o("#app-content #modal-form-plan").on("show.bs.modal",(function(t){o("#lista-categorias option").length<=1&&i(),r(),o("#lista-planos option").length<=1&&c(),o("#form-config-plan")[0].reset(),o('#form-config-plan [name="servico_id"] option').each((function(){o(this).prop("selected",!1),o(this).text(o(this).text().replace("✔","")),o(this).removeClass("bg-black"),o(this).removeClass("text-white")}))})),o("#lista-servicos").click((function(t){t.target.innerHTML=t.target.innerHTML.replace("✔",""),n.includes(t.target.value)?(n.splice(n.indexOf(t.target.value),1),t.target.classList.remove("bg-black"),t.target.classList.remove("text-white")):(n.push(t.target.value),t.target.innerHTML=`&#x2714; ${t.target.innerHTML}`,t.target.classList.add("bg-black"),t.target.classList.add("text-white")),o("#lista-servicos").val(n)})),o("#app-content #form-config-plan").on("submit",(function(t){t.preventDefault(),function(){const t=[];o("#lista-servicos option:selected").each((function(){t.push({plano_servico_id:o('#form-config-plan [name="plano_servico_id"]').val(),categoria_servico_id:o('#form-config-plan [name="categoria_servico_id"]').val(),servico_id:o(this).val()})})),fetch("/api/v1/plano",{method:"POST",body:JSON.stringify(t),headers:{"X-CSRF-TOKEN":o('meta[name="csrf-token"]').attr("content"),"Content-Type":"application/json",Accept:"application/json"}}).then((async t=>{const e=await t.json();t.ok&&(o("#form-config-plan")[0].reset(),w(),Swal.fire({icon:"success",title:"Sucesso",text:e.message}))})).catch((t=>{console.error("Erro ao carregar os dados:",t)}))}()})),T("#modal-form-plan #nav-tab a").on("click",(function(){"#nav-plan"===T(this).attr("href")?(d(),s(".currency").on("input",(function(){let t=s(this).val();t=t.replace(/\D/g,""),t=(Number(t)/100).toFixed(2),s(this).val(new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t))})),s("#app-content").on("click","#tb-services-plans button",(function(){var t;"edit"==s(this).data("action")?(t=l.find((t=>t.id==s(this).data("id"))),Object.keys(t).forEach((e=>{["valor_mensal","valor_anual"].includes(e)?s(`[name="${e}"]`).val(t[e]).trigger("input"):s(`[name="${e}"]`).val(t[e])}))):"delete"==s(this).data("action")&&function(t){Swal.fire({title:"Exclusão de plano de servico",text:"Voce não poderá reverter esta ação!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, excluir!"}).then((e=>{e.isConfirmed&&u({method:"DELETE",headers:{"X-CSRF-TOKEN":s('meta[name="csrf-token"]').attr("content"),Accept:"application/json"},credentials:"include"},`/api/v1/plano-servico/${t.id}`)}))}(l.find((t=>t.id==s(this).data("id"))))})),s("#form-service-plan").on("submit",(function(t){t.preventDefault();const e=s('#form-service-plan input[name="id"]').val();0!=e?function(){const t=new FormData(document.querySelector("#form-service-plan"));t.set("valor_mensal",m(t.get("valor_mensal"))),t.set("valor_anual",m(t.get("valor_anual"))),t.append("_method","PUT"),u({method:"POST",headers:{"X-CSRF-TOKEN":s('meta[name="csrf-token"]').attr("content"),Accept:"application/json"},body:t},"/api/v1/plano-servico")}(l.find((t=>t.id==e))):function(){const t=new FormData(document.querySelector("#form-service-plan"));t.set("valor_mensal",m(t.get("valor_mensal"))),t.set("valor_anual",m(t.get("valor_anual"))),u({method:"POST",headers:{"X-CSRF-TOKEN":s('meta[name="csrf-token"]').attr("content"),"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"include",body:t})}()})),s("#colorPickerButton").on("click",(function(){s("#colorPicker").click()})),s("#colorPicker").change((function(){s('#form-service-plan input[name="cor"]').val(s(this).val())})),s('#form-service-plan input[name="cor"]').on("input",(function(){s("#colorPicker").val(s(this).val())}))):"#nav-category"===T(this).attr("href")?(b("#form-category")[0].reset(),b("#tb-categories").on("click","button",(function(){if("edit"==b(this).data("action")){const t=_.find((t=>t.id==b(this).data("id")));b('#form-category input[name="id"]').val(t.id),b('#form-category input[name="nome"]').val(t.nome)}else if("delete"==b(this).data("action")){const t=_.find((t=>t.id==b(this).data("id")));Swal.fire({title:`Exclusão de categoria ${t.nome}`,text:"Voce não poderá reverter essa ação!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, excluir!"}).then((e=>{var a;e.isConfirmed&&(a=t.id,x({method:"DELETE",headers:{"X-CSRF-TOKEN":b('meta[name="csrf-token"]').attr("content"),"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"include"},`/api/v1/categoria-servico/${a}`))}))}})),y(),b("#form-category").submit((function(t){t.preventDefault(),b('#form-category input[name="id"]').val()>0?function(){const t=new FormData(document.getElementById("form-category"));t.get("nome")!=_.find((e=>e.id==t.get("id"))).nome?(t.append("_method","PUT"),x({method:"POST",headers:{"X-CSRF-TOKEN":b('meta[name="csrf-token"]').attr("content"),"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"include",body:t})):b("#form-category")[0].reset()}():function(){const t=new FormData(document.getElementById("form-category"));x({method:"POST",headers:{"X-CSRF-TOKEN":b('meta[name="csrf-token"]').attr("content"),"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"include",body:t})}()}))):"#nav-service"===T(this).attr("href")&&(f("#form-service")[0].reset(),v(),f("#form-service").on("submit",(function(t){t.preventDefault();const e=f('#form-service input[name="id"]').val();0!=e?function(){const t=new FormData(document.querySelector("#form-service"));t.append("_method","PUT"),g({method:"POST",headers:{"X-CSRF-TOKEN":f('meta[name="csrf-token"]').attr("content"),"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:t})}(h.find((t=>t.id==e))):g({method:"POST",headers:{"X-CSRF-TOKEN":f('meta[name="csrf-token"]').attr("content"),Accept:"application/json"},body:new FormData(document.querySelector("#form-service"))})})),f("#tb-services").on("click","button",(function(){if("edit"==f(this).data("action")){const t=h.find((t=>t.id==f(this).data("id")));f('#form-service input[name="id"]').val(t.id),f('#form-service input[name="nome"]').val(t.nome)}else if("delete"==f(this).data("action")){const t=h.find((t=>t.id==f(this).data("id")));Swal.fire({title:`Exclusão de categoria ${t.nome}`,text:"Voce não poderá reverter essa ação!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, excluir!"}).then((e=>{var a;e.isConfirmed&&(a=t.id,g({method:"DELETE",headers:{"X-CSRF-TOKEN":f('meta[name="csrf-token"]').attr("content"),Accept:"application/json"}},`/api/v1/servico/${a}`))}))}})))}))}))})();